<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>陕西终端公司毛利分析</title>
  
  <link rel="stylesheet" href="css/app.css">
  <style type="text/css">

  </style>
  
  <script type="text/javascript" src="js/vue.js"></script>
  <script type="text/javascript" src="js/lib.js"></script>
  <script type="text/javascript" src="js/index.js"></script>

</head>
<body id="app">
  <p>陕西终端公司毛利分析</p>
  <div >
    
    <div id="msg_area">
        <div v-for="a_msg in run_msg">
          {{a_msg}} 
        </div>
        <div class="err_msg" v-for="a_msg in err_msg">
          {{a_msg}} 
        </div>
    </div>

    <div id="cmd_area">
      工作目录：
      <div v-for="a_step in step_array">
        <span v-if="step>=a_step.idx">
        {{a_step.desc}} 
        <button :disabled="!(step==a_step.idx)" @click="a_step.func" > 运行 </button><br/><br/>
        </span>
      </div>
    </div>

  </div>

  <div id="debug_area">
    step:<input  type="number" v-model="step"  name="btn_1" />
    {{step}}
  </div>



<script type="text/javascript">

var fs = require('fs');
var _ = require('underscore');
var xlsx = require("node-xlsx");

var MSG = Msg.createNew();
var ERR_MSG = Msg.createNew();

var ORDER_DETAIL = null;


var vm = new Vue({
  el: '#app',
  data: {
    run_flag: true,
    step:101,
    step_array:[],
    run_msg: MSG.msg_list,
    err_msg: ERR_MSG.msg_list
  },
  methods: {
    getPwd: function () {
      console.log("This is test function.");
    }
  }
});

var make_step = function( i_index, s_desc, f_func_name ){
  var obj_step = {};
  obj_step.idx = i_index;
  obj_step.desc = s_desc;
  obj_step.func = f_func_name;
  return obj_step;
};

var put_msg = function( msg ){
  vm.run_msg.push( msg );
}

var put_err_msg = function( msg ){
  vm.err_msg.push( msg );
}



vm.step_array.push( make_step( 101, "第一步：检查环境。", check_evn_101 ) );
vm.step_array.push( make_step( 102, "第二步：检查状态。", check_status_102 ) );
vm.step_array.push( make_step( 103, "第三步：检查输入文件是否齐备。", check_src_103 ) );
vm.step_array.push( make_step( 104, "第四步：读入销售订单明细，并检查内容。", load_order_detail_104 ) );
vm.step_array.push( make_step( 105, "第五步：拷贝必要的数据列到临时文件。", copy_order_detail_105 ) );

init_100();

console.log(vm.step_array);
</script>
</body>
</html>




